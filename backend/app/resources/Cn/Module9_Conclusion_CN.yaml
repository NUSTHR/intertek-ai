module_id: 9 #"09_compliance_conclusions"
title: "最终合规判定"
description: "根据第 2024/1689 号条例（欧盟），将参数状态映射到最终法律结论和综合义务视图。"

# ==============================================================================
# VARIABLES SECTION
# Determines Type， Risk_level， and View dynamically based on logic.
# ==============================================================================

variables:
  - name: "Type"
    type: "string"
    initial_value: "Undetermined"
    rules:
      - condition: "AI_type == 3"
        value: "Non-regulated products"
      - condition: "AI_type == 1"
        value: "General-Purpose AI Model"
      - condition: "AI_type == 2"
        value: "AI System"
      - condition: "else"
        value: "Undetermined"

  - name: "Risk_level"
    type: "string"
    initial_value: "Undetermined"
    rules:
      # Group 1: Hard Stops
      - condition: "Totally_excluded == True"
        value: "Out of Regulation"
      - condition: "System_excluded == True"
        value: "Out of Regulation"
      - condition: "Unacceptable_risk == True"
        value: "Unacceptable Risk (Prohibited practices)"
      - condition: "AI_type == 3"
        value: "Out of Regulation"
      
      # Group 2: Real World Testing (RWT) overrides
      - condition: "Real_world_Testing == True and AI_type == 2 and High_risk == True and Transparency_obligation == True"
        value: "High Risk with Additional Transparency Obligation (Real World Testing)"
      - condition: "Real_world_Testing == True and AI_type == 2 and High_risk == True and Transparency_obligation == False"
        value: "High Risk (Real World Testing)"
      - condition: "Real_world_Testing == True and AI_type == 2 and High_risk == False and Transparency_obligation == True"
        value: "Transparency Obligation Only"
      - condition: "Real_world_Testing == True and AI_type == 2 and High_risk == False and Transparency_obligation == False"
        value: "Minimal Risk"
      # Group 3: GPAI Market Placement
      - condition: "AI_type == 1 and Systematic_risk == True"
        value: "Systemic Risk GPAI"
      - condition: "AI_type == 1 and Systematic_risk == False and Open_source == False"
        value: "Standard GPAI"
      - condition: "AI_type == 1 and Systematic_risk == False and Open_source == True"
        value: "Standard GPAI (Open Source Exempt)"

      # Group 4: AI Systems Market Placement
      - condition: "AI_type == 2 and High_risk == True and Transparency_obligation == True"
        value: "High Risk with Additional Transparency Obligations"
      - condition: "AI_type == 2 and High_risk == True and Transparency_obligation == False"
        value: "High Risk"
      - condition: "AI_type == 2 and High_risk == False and Transparency_obligation == True"
        value: "Transparency Obligation Only"
      - condition: "AI_type == 2 and High_risk == False and Transparency_obligation == False"
        value: "Minimal Risk"
      - condition: "Role == 'Undetermined'"
        value: "No Regulated Role Identified"
      # Fallback
      - condition: "else"
        value: "Undetermined"

  # ==============================================================================
  # NEW TRANSLATION VARIABLES (Added per request)
  # ==============================================================================

  - name: "Role_CN"
    type: "string"
    initial_value: "未确定"
    rules:
      - condition: "Role == 'provider'"
        value: "提供者"
      - condition: "Role == 'deployer'"
        value: "部署者"
      - condition: "Role == 'importer'"
        value: "进口商"
      - condition: "Role == 'distributor'"
        value: "分销商"
      - condition: "Role == 'authorized_representative'"
        value: "授权代表"
      - condition: "Role == 'product_manufacturer'"
        value: "产品制造商"
      - condition: "Role == 'Undetermined'"
        value: "未确定"
      - condition: "else"
        value: "未确定"

  - name: "Type_CN"
    type: "string"
    initial_value: "未确定"
    rules:
      - condition: "Type == 'Non-regulated products'"
        value: "非受监管产品"
      - condition: "Type == 'General-Purpose AI Model'"
        value: "通用人工智能模型"
      - condition: "Type == 'AI System'"
        value: "人工智能系统"
      - condition: "else"
        value: "未确定"

  - name: "Risk_level_CN"
    type: "string"
    initial_value: "未确定"
    rules:
      - condition: "Risk_level == 'Out of Regulation'"
        value: "不受监管"
      - condition: "Risk_level == 'Unacceptable Risk (Prohibited practices)'"
        value: "不可接受风险（被禁止的做法）"
      - condition: "Risk_level == 'High Risk with Additional Transparency Obligation (Real World Testing)'"
        value: "具有透明度义务的高风险（真实世界测试）"
      - condition: "Risk_level == 'High Risk (Real World Testing)'"
        value: "高风险（真实世界测试）"
      - condition: "Risk_level == 'Transparency Obligation Only'"
        value: "仅透明度义务"
      - condition: "Risk_level == 'Minimal Risk'"
        value: "最小风险"
      - condition: "Risk_level == 'Systemic Risk GPAI'"
        value: "具有系统风险的通用人工智能模型"
      - condition: "Risk_level == 'Standard GPAI'"
        value: "标准通用人工智能模型"
      - condition: "Risk_level == 'Standard GPAI (Open Source Exempt)'"
        value: "标准通用人工智能模型（开源豁免）"
      - condition: "Risk_level == 'High Risk with Additional Transparency Obligations'"
        value: "具有透明度义务的高风险"
      - condition: "Risk_level == 'High Risk'"
        value: "高风险"
      - condition: "Risk_level == 'Transparency Obligation Only'"
        value: "仅透明度义务"
      - condition: "Risk_level == 'Minimal Risk'"
        value: "最小风险"
      - condition: "Risk_level == 'No Regulated Role Identified'"
        value: "未识别出受监管角色"
      - condition: "else"
        value: "未确定"

  # ==============================================================================
  # EXISTING OUTPUT VARIABLES
  # ==============================================================================

  - name: "Risk_Level_Reason"
    type: "string"
    initial_value: "Reason undetermined."
    rules:
      # 第 1 组：硬性排除（提取自模块 1、3、4）
      - condition: "Totally_excluded == True"
        value: "此活动不属于《人工智能法案》的适用范围。原因：{{Exclusion_reason}}" 
      - condition: "System_excluded == True"
        value: "该系统属于法规明确豁免的对象。原因：{{Exclusion_Reason}}" 
      - condition: "Unacceptable_risk == True"
        value: "此人工智能实践被归类为“不可接受风险”，受到严格禁止。原因：{{Prohibited_reason}}" 
      - condition: "AI_type == 3"
        value: "该软件不在此法规管辖范围内，因为它不符合第 3 条中关于“人工智能系统”或“通用人工智能模型”的法律定义。"

      # 第 2 组：真实世界测试（RWT）覆盖规则
      - condition: "Real_world_Testing == True and AI_type == 2 and High_risk == True"
        value: "您正在对高风险人工智能系统进行真实世界测试。该高风险状态适用的原因是：{{High_risk_reason}}。因此，该测试受第 60 条治理要求的管辖。"
      - condition: "Real_world_Testing == True and AI_type == 2 and High_risk == False and Transparency_obligation == True"
        value: "您正在对涉及人机交互或内容生成的系统进行真实世界测试。这触发了透明度义务，原因是：{{Transparency_Reasons}}。即使在测试期间，您也必须遵守第 50 条的规定。"
      - condition: "Real_world_Testing == True and AI_type == 2 and High_risk == False and Transparency_obligation == False"
        value: "您正在对归类为最小风险的系统进行真实世界测试。此状态适用是因为该系统不满足不可接受风险、高风险或透明度义务的任何条件。因此，《人工智能法案》未对此测试施加特定的监管要求。"

      # 第 3 组：通用人工智能模型（GPAI）市场投放（提取自模块 7）
      - condition: "AI_type == 1 and Systematic_risk == True"
        value: "此模型被归类为具有系统性风险的通用人工智能模型。原因：{{Systematic_reason}}" 
      - condition: "AI_type == 1 and Systematic_risk == False"
        value: "此模型被归类为标准通用人工智能模型。它未达到系统性风险的阈值，因为：{{Systematic_reason}}。"

      # 第 4 组：人工智能系统市场投放（提取自模块 5 和 6）
      - condition: "AI_type == 2 and High_risk == True and Transparency_obligation == True"
        value: "此系统被归类为高风险，原因是：{{High_risk_reason}}。此外，它还需履行透明度义务，原因是：{{Transparency_Reasons}}。"
      - condition: "AI_type == 2 and High_risk == True and Transparency_obligation == False"
        value: "此系统被归类为高风险。原因：{{High_risk_reason}}"
      - condition: "AI_type == 2 and High_risk == False and Transparency_obligation == True"
        value: "此系统被归类为有限风险，并须履行透明度义务。原因：{{Transparency_Reasons}}"
      - condition: "AI_type == 2 and High_risk == False and Transparency_obligation == False"
        value: "此系统被归类为最小风险，因为它不满足法规中定义的不可接受风险、高风险或透明度义务的任何条件。"

      # 回退选项
      - condition: "else"
        value: "无法根据提供的输入确定具体的风险分类原因。"

  - name: "Role_Description"
    type: "string"
    initial_value: "No regulated role identified based on current inputs."
    rules:
      - condition: "Role == 'provider'"
        value: "根据第 3(3) 条，您是开发 AI 系统或通用 AI 模型，或让人开发并以您的名义或商标将其投放市场或投入使用的实体。"
      - condition: "Role == 'deployer'"
        value: "根据第 3(4) 条，您是在您的权限下将 AI 系统用于职业目的（不包括个人非职业活动）的实体。"
      - condition: "Role == 'importer'"
        value: "根据第 3(6) 条，您是位于欧盟境内，将冠以第三国设立的自然人或法人名称或商标的 AI 系统投放市场的实体。"
      - condition: "Role == 'distributor'"
        value: "根据第 3(7) 条，您是供应链中除提供者或进口商之外，使 AI 系统在欧盟市场上可获得的实体。"
      - condition: "Role == 'authorized_representative'"
        value: "根据第 3(5) 条，您是位于欧盟境内，已收到并接受提供者的书面授权，代表其履行特定义务和程序的实体。"
      - condition: "Role == 'product_manufacturer'"
        value: "根据第 2(1)(e) 条，您是将 AI 系统与您的产品一起并以您的名义或商标投放市场或投入使用的制造商。"
      - condition: "Role == 'Undetermined'"
        value: "根据提供的输入，实体的法律角色仍未定义，无法确定《人工智能法》下的具体责任或义务。"

  - name: "Product_Type_Description"
    type: "string"
    initial_value: "Product type undetermined."
    rules:
      - condition: "Type == 'AI System'"
        value: "根据第 3(1) 条，这是一个基于机器的系统，设计为以不同程度的自主性运行，从输入中推断如何生成通过预测、内容、推荐或决定的形式影响环境的输出。"
      - condition: "Type == 'General-Purpose AI Model'"
        value: "根据第 3(63) 条，这是一种显示出显著通用性、能够胜任广泛的独特任务，并可以集成到各种下游系统或应用中的 AI 模型。"
      - condition: "Type == 'Non-regulated products'"
        value: "根据用户输入，该软件不符合第 3(1) 条下人工智能系统或第 3(63) 条下通用人工智能模型的定义，因此不属于《人工智能法》的适用范围。"

  - name: "View"
    type: "string"
    initial_value: ""
    rules:
      # ------------------------------------------------------------------------
      # PRIORITY 1: HARD EXCLUSIONS (绝对排除 - 法规不适用)
      # ------------------------------------------------------------------------
      - condition: "Totally_excluded == True"
        value: |
          该活动不属于《人工智能法案》的监管范围。只要该项目保持在特定界限内（例如纯粹的科学研究与开发，或投放市场前的研发活动），目前无需履行本法规规定的强制性法律义务、风险管理标准或接受监管监督。
          如果想了解更全面的法规细节，建议您参考条款 Article 2(6) (研究豁免)， Article 2(8) (投放市场前的研发)。

      - condition: "System_excluded == True"
        value: |
          该系统符合第 2 条规定的特定豁免条件。若系统专用于军事、国防或国家安全目的，或者由第三国公共当局在充分保障措施下用于国际执法合作，则适用此豁免。请注意，“军民两用”系统（即同时用于民用和军用）不符合军事豁免条件。
          如果想了解更全面的法规细节，建议您参考条款 Article 2(3) (军事/国家安全)， Article 2(4) (第三国执法)。

      - condition: "Type == 'Non-regulated products'"
        value: |
          该软件不符合第 3(1) 条关于“人工智能系统”或第 3(63) 条关于“通用人工智能模型”的法律定义。因此，它不在《人工智能法案》的监管范围内。您应严格监控软件的开发，确保其性质未发生改变从而演变为人工智能系统（例如，增加了自主性或推理能力），并继续遵守《通用产品安全法规》等适用框架。
          如果想了解更全面的法规细节，建议您参考条款 Article 3(1) (AI系统定义)， Article 3(63) (GPAI模型定义)。

      # ------------------------------------------------------------------------
      # PRIORITY 2: PROHIBITIONS (禁止行为 - 法规禁止该活动)
      # ------------------------------------------------------------------------
      - condition: "Unacceptable_risk == True"
        value: |
          该人工智能实践被归类为“不可接受风险”，根据《人工智能法案》第 5 条被严格禁止。被禁止的做法包括潜意识操纵技术、利用弱点、社会评分、无针对性的面部图像抓取以及在工作场所/学校进行情绪识别。包括提供者，部署着，分销商和进口商在内的所有相关运营者均不得将此系统投放市场或投入使用。
          如果想了解更全面的法规细节，建议您参考条款 Article 5 (禁止的人工智能实践)。

      # ------------------------------------------------------------------------
      # PRIORITY 3: ROLE CHECK (角色核查)
      # ------------------------------------------------------------------------
      - condition: "Role == 'Undetermined'"
        value: |
          您的实体目前不符合受监管经济运营者（如提供者、部署者、进口商、分销商或授权代表）的定义。请仔细审查第 25 条，确保您未以自己的名义或商标将 AI 系统投放市场，因为这种行为会导致您被视为“产品制造商”并承担提供者的义务。
          如果想了解更全面的法规细节，建议您参考条款 Article 3 (定义)， Article 25 (AI价值链中的责任)。

      # ------------------------------------------------------------------------
      # PRIORITY 3: REAL WORLD TESTING (EXPANDED) (真实世界测试 - 扩展)
      # ------------------------------------------------------------------------
      - condition: "(Risk_level == 'High Risk with Additional Transparency Obligation (Real World Testing)') and (Role == 'provider')"
        value: |
          作为提供者 (Provider)，您必须向市场监管机构提交真实世界测试计划，在欧盟数据库中注册该测试，并获得受试者的知情同意。此外，您还必须确保受影响的人员能够察觉该系统是人工智能。
          如果想了解更全面的法规细节，建议您参考条款 Article 60 (真实世界测试)， Article 61 (知情同意)， Article 50 (透明度)， Article 71 (注册)。

      - condition: "(Risk_level == 'High Risk with Additional Transparency Obligation (Real World Testing)') and (Role != 'provider')"
        value: |
          您可能是潜在部署者 (Prospective Deployer) 或合作伙伴。您必须与提供者签署协议，明确规定双方的角色和责任。您必须确保受试者被告知其正在与人工智能互动。如果您是授权代表，您可能需要协助进行注册。
          如果想了解更全面的法规细节，建议您参考条款 Article 60 (测试条件)， Article 61 (知情同意)， Article 50 (透明度)。

      - condition: "(Risk_level == 'High Risk (Real World Testing)') and (Role == 'provider')"
        value: |
          作为提供者 (Provider)，您必须制定并向市场监管机构提交测试计划。您必须在欧盟数据库中注册该测试，并确保获得所有受试者的知情同意。
          如果想了解更全面的法规细节，建议您参考条款 Article 60 (真实世界测试)， Article 61 (知情同意)， Article 71 (欧盟数据库)。

      - condition: "(Risk_level == 'High Risk (Real World Testing)') and (Role != 'provider')"
        value: |
          作为潜在部署者 (Prospective Deployer) 或合作伙伴，您必须严格遵守与提供者签署的协议，并确保遵循使用说明。您必须对测试环境进行监督以保障受试者的安全。
          如果想了解更全面的法规细节，建议您参考条款 Article 60 (测试条件)， Article 61 (知情同意)。

      # ------------------------------------------------------------------------
      # PRIORITY 4: GENERAL-PURPOSE AI (GPAI) (通用人工智能)
      # ------------------------------------------------------------------------
      - condition: "(Risk_level == 'Systemic Risk GPAI' and Open_source == False) and (Role == 'provider')"
        value: |
          作为具有系统性风险的通用人工智能模型的提供者 (Provider)，您必须向欧盟委员会通报您的系统性风险状态，维护技术文档，进行对抗性测试（红队测试），并确保网络安全。
          如果想了解更全面的法规细节，建议您参考条款 Article 52 (通报)， Article 53 (文档)， Article 55 (系统性风险义务)。

      - condition: "(Risk_level == 'Systemic Risk GPAI' and Open_source == False) and (Role != 'provider')"
        value: |
          授权代表 (Authorised Representatives) 必须持有授权书以验证文档并配合人工智能办公室的工作。集成该模型的进口商和下游提供者必须确保原提供者已履行其义务；如果您将此模型集成到高风险系统中，您将承担该系统的提供者义务。
          如果想了解更全面的法规细节，建议您参考条款 Article 54 (授权代表)， Article 25 (价值链)。

      - condition: "(Risk_level == 'Systemic Risk GPAI' and Open_source == True) and (Role == 'provider')"
        value: |
          作为提供者 (Provider)，“系统性风险”的分类使得通常的开源豁免不再适用。您必须评估模型，减轻系统性风险，并报告严重事故。
          如果想了解更全面的法规细节，建议您参考条款 Article 53(2) (例外限制)， Article 55 (系统性风险义务)。

      - condition: "(Risk_level == 'Systemic Risk GPAI' and Open_source == True) and (Role != 'provider')"
        value: |
          授权代表必须协助非欧盟提供者确保合规。尽管采用开源许可，下游提供者仍需将其视为受监管模型，确保集成该模型的自有系统符合合规要求。
          如果想了解更全面的法规细节，建议您参考条款 Article 54 (授权代表)， Article 55 (系统性风险义务)。

      - condition: "(Risk_level == 'Standard GPAI') and (Role == 'provider')"
        value: |
          作为标准通用人工智能模型的提供者 (Provider)，您必须维护技术文档，向下游提供者提供信息，遵守版权法，并发布训练内容摘要。
          如果想了解更全面的法规细节，建议您参考条款 Article 53 (GPAI提供者义务)。

      - condition: "(Risk_level == 'Standard GPAI') and (Role != 'provider')"
        value: |
          授权代表必须验证技术文档是否已制定，并保存副本以供人工智能办公室查阅。下游提供者需依据提供的文档来确保自身的合规性。
          如果想了解更全面的法规细节，建议您参考条款 Article 54 (授权代表)， Article 53 (下游信息)。

      - condition: "(Risk_level == 'Standard GPAI (Open Source Exempt)') and (Role == 'provider')"
        value: |
          作为基于免费和开源许可的标准 GPAI 模型提供者 (Provider)，您可免除大多数文档义务。但是，您仍必须制定政策以尊重版权法，并发布用于训练的内容摘要。
          如果想了解更全面的法规细节，建议您参考条款 Article 53(2) (开源豁免)， Article 53(1)(c)-(d) (版权与摘要)。

      - condition: "(Risk_level == 'Standard GPAI (Open Source Exempt)') and (Role != 'provider')"
        value: |
          对于开源非系统性风险模型，通常不需要授权代表。下游提供者应验证版权合规政策是否到位。
          如果想了解更全面的法规细节，建议您参考条款 Article 54(4) (授权代表豁免)， Article 53(1)(c) (版权)。

      # ------------------------------------------------------------------------
      # PRIORITY 5: HIGH RISK & TRANSPARENCY (高风险与透明度)
      # ------------------------------------------------------------------------
      - condition: "(Risk_level == 'High Risk with Additional Transparency Obligations') and (Role == 'provider')"
        value: |
          作为提供者 (Provider)，您必须履行所有高风险义务（符合性评估、质量管理体系）。此外，您必须设计系统以确保自然人知晓其正在与人工智能互动（例如情绪识别系统）。
          如果想了解更全面的法规细节，建议您参考条款 Article 16 (提供者义务)， Article 50 (透明度)。

      - condition: "(Risk_level == 'High Risk with Additional Transparency Obligations') and (Role == 'deployer')"
        value: |
          作为部署者 (Deployer)，您必须监控系统并确保人为监督。您直接负责告知暴露于系统（例如情绪识别受试者）的人员系统的运行情况。
          如果想了解更全面的法规细节，建议您参考条款 Article 26 (部署者义务)， Article 50(3) (情绪识别披露)。

      - condition: "(Risk_level == 'High Risk with Additional Transparency Obligations') and ((Role != 'provider') and (Role != 'deployer'))"
        value: |
          进口商和分销商必须在系统上市前验证其是否带有必要的标记和说明。授权代表必须验证符合性声明 (Declaration of Conformity)。以自己名义投放 AI 的产品制造商需承担提供者义务。
          如果想了解更全面的法规细节，建议您参考条款 Article 23 (进口商)， Article 24 (分销商)， Article 22 (授权代表)， Article 25 (制造商)。

      - condition: "(Risk_level == 'High Risk') and (Role == 'provider')"
        value: |
          作为高风险 AI 系统的提供者 (Provider)，您必须建立风险管理系统，确保数据治理，起草技术文档，并进行符合性评估。
          如果想了解更全面的法规细节，建议您参考条款 Article 9 (风险管理)， Article 16 (提供者义务)， Article 43 (符合性)。

      - condition: "(Risk_level == 'High Risk') and (Role == 'deployer')"
        value: |
          作为高风险 AI 系统的部署者 (Deployer)，您必须按照说明使用系统，保持人为监督，在某些情况下还需进行基本权利影响评估 (FRIA)。
          如果想了解更全面的法规细节，建议您参考条款 Article 26 (部署者义务)， Article 27 (FRIA)。

      - condition: "(Risk_level == 'High Risk') and ((Role != 'provider') and (Role != 'deployer'))"
        value: |
          进口商必须确保提供者已完成符合性评估并指定了代表。分销商必须验证 CE 标志和文档。授权代表充当欧盟联络点并持有文档。集成 AI 的产品制造商若以其名义销售，则成为提供者。
          如果想了解更全面的法规细节，建议您参考条款 Article 23 (进口商)， Article 24 (分销商)， Article 22 (授权代表)， Article 25 (制造商)。

      - condition: "(Risk_level == 'Transparency Obligation Only') and (Role == 'provider')"
        value: |
          作为提供者 (Provider)，您必须设计系统，使其输出以机器可读格式进行标记，并可被检测为人工生成（例如深度伪造）。您必须确保系统允许部署者履行其披露义务。
          如果想了解更全面的法规细节，建议您参考条款 Article 50 (透明度义务)。

      - condition: "(Risk_level == 'Transparency Obligation Only') and (Role == 'deployer')"
        value: |
          作为聊天机器人、深度伪造或情绪识别系统的部署者 (Deployer)，您有责任向受影响的自然人披露内容或互动的人工智能性质。
          如果想了解更全面的法规细节，建议您参考条款 Article 50 (透明度义务)。

      - condition: "(Risk_level == 'Transparency Obligation Only') and (Role != 'provider' and Role != 'deployer')"
        value: |
          分销商和进口商在提供系统之前，必须验证系统是否带有履行第 50 条所需的标记或文档。集成此类工具的产品制造商必须确保最终产品保留这些透明度功能。
          如果想了解更全面的法规细节，建议您参考条款 Article 50 (透明度)， Article 23-24 (一般验证责任)。

      # ------------------------------------------------------------------------
      # PRIORITY 6: MINIMAL RISK (最低风险)
      # ------------------------------------------------------------------------
      - condition: "Risk_level == 'Minimal Risk'"
        value: |
          该系统属于最低风险类别。人工智能法案对此类系统不强制规定义务。但是，鼓励提供者和部署者自愿遵守行为准则，以促进可信赖的人工智能。
          如果想了解更全面的法规细节，建议您参考条款 Article 95 (行为准则)。

router:
  - condition: "True"
    action: "terminate"
    message: "Generate the report"